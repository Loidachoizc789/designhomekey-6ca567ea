import{r as t,D as w,j as e,I as m,B as u,q as r,E as h}from"./index-Cz-rwPxk.js";import{a as p,L as N}from"./label-zMVBXziF.js";const E=()=>{const[n,g]=t.useState(""),[i,x]=t.useState(""),[l,o]=t.useState(!1),c=w(),f=async s=>{s.preventDefault(),o(!0);try{const{data:a,error:d}=await r.auth.signInWithPassword({email:n,password:i});if(d)throw d;if(a.user){const{data:j,error:v}=await r.from("user_roles").select("role").eq("user_id",a.user.id).eq("role","admin").single();if(v||!j)throw await r.auth.signOut(),new Error("Bạn không có quyền truy cập admin");h({title:"Đăng nhập thành công",description:"Chào mừng bạn đến trang quản trị"}),c("/admin")}}catch(a){console.error("Login error:",a),h({title:"Lỗi đăng nhập",description:a instanceof Error?a.message:"Email hoặc mật khẩu không đúng",variant:"destructive"})}finally{o(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"glass-card p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"/lovable-uploads/1052d8d6-1118-4206-be15-c73ee5a0188e.png",alt:"DesignHomeKey",className:"h-16 mx-auto mb-4"}),e.jsx("h1",{className:"font-display text-2xl font-bold",children:"Đăng Nhập Admin"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Đăng nhập để quản lý nội dung website"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",type:"email",value:n,onChange:s=>g(s.target.value),placeholder:"admin@example.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"password",children:"Mật khẩu"}),e.jsx(m,{id:"password",type:"password",value:i,onChange:s=>x(s.target.value),placeholder:"••••••••",required:!0})]}),e.jsxs(u,{type:"submit",className:"w-full",disabled:l,children:[l&&e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}),"Đăng nhập"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Chưa có tài khoản?"," ",e.jsx(u,{variant:"link",className:"p-0",onClick:()=>c("/admin/setup"),children:"Tạo admin đầu tiên"})]})})]})})};export{E as default};
